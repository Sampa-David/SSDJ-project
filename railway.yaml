services:
  web:
    name: ssdj-web
    source:
      type: github
      repo: Sampa-David/SSDJ-project
      branch: main
    
    # Build command - runs deployment script
    buildCommand: bash ./bin/railway-deploy.sh
    
    # Start command - simple PHP built-in server
    startCommand: php -S 0.0.0.0:8080 -t public
    
    # Health check
    healthCheckUrl: /
    healthCheckInterval: 30
    
    # Port configuration
    port: 8080
    
    # Environment variables
    variables:
      # Application
      APP_ENV: production
      APP_DEBUG: false
      APP_NAME: "SSDJ Event System"
      
      # Logging
      LOG_CHANNEL: stack
      LOG_LEVEL: error
      
      # Cache & Session (use database for reliability)
      SESSION_DRIVER: database
      CACHE_DRIVER: database
      QUEUE_CONNECTION: database
      
      # Database
      DB_CONNECTION: mysql
      DB_HOST: ssdj-db
      DB_PORT: "3306"
      DB_DATABASE: ssdj
      DB_USERNAME: railway
      DB_PASSWORD: railway

  database:
    name: ssdj-db
    source:
      type: mysql
      version: "8.0"
    
    variables:
      MYSQL_DATABASE: ssdj
      MYSQL_USER: railway
      MYSQL_PASSWORD: railway
      MYSQL_ROOT_PASSWORD: railway
